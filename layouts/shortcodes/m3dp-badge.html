{{/* 
  Minimal3DP Badge Shortcode
  
  Usage:
    {{< m3dp-badge type="calculator" href="/tools/calculator/" >}}Cost Calculator{{< /m3dp-badge >}}
    {{< m3dp-badge type="app" size="lg" >}}Download App{{< /m3dp-badge >}}
    {{< m3dp-badge type="youtube" >}}Subscribe{{< /m3dp-badge >}}
  
  Parameters:
    - type (optional): calculator, app, youtube, email, support (default: neutral gray)
    - href (optional): Link URL (if omitted, renders as span)
    - size (optional): sm, lg (default: base)
    - icon (optional): Icon HTML or emoji to display before text
    - location (optional): For analytics tracking (e.g., "sidebar", "homepage")
    - target (optional): Link target attribute (default: "_self", use "_blank" for external)
    - rel (optional): Link rel attribute (default: none, suggest "noopener noreferrer" for _blank)
  
  Inner content: Badge label text
*/}}

{{ $type := .Get "type" | default "" }}
{{ $href := .Get "href" }}
{{ $size := .Get "size" | default "" }}
{{ $icon := .Get "icon" }}
{{ $location := .Get "location" | default "unspecified" }}
{{ $target := .Get "target" | default "_self" }}
{{ $rel := .Get "rel" | default "" }}
{{ $label := .Inner | markdownify | plainify }}

{{/* Build class string */}}
{{ $classes := "m3dp-badge" }}
{{ if $type }}
  {{ $classes = printf "%s m3dp-badge--%s" $classes $type }}
{{ end }}
{{ if $size }}
  {{ $classes = printf "%s m3dp-badge--%s" $classes $size }}
{{ end }}

{{/* Render as link or span */}}
{{ if $href }}
  <a href="{{ $href }}" 
     class="{{ $classes }}"
     {{ if ne $target "_self" }}target="{{ $target }}"{{ end }}
     {{ if $rel }}rel="{{ $rel }}"{{ end }}
     onclick="trackCtaClick('badge', '{{ $type }}', '{{ $location }}')">
    {{ if $icon }}
      <span class="m3dp-badge__icon">{{ $icon | safeHTML }}</span>
    {{ end }}
    <span class="m3dp-badge__label">{{ $label }}</span>
  </a>
{{ else }}
  <span class="{{ $classes }}">
    {{ if $icon }}
      <span class="m3dp-badge__icon">{{ $icon | safeHTML }}</span>
    {{ end }}
    <span class="m3dp-badge__label">{{ $label }}</span>
  </span>
{{ end }}
